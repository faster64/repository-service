<div class="ts-main page-cloking">
  <div class="col-wrap">
    <div class="main">
      <div class="header">
        <div class="container">
          <div class="name-custome"><h2>{{vm.employee.name}}</h2></div>
          <div class="header-info">
            <div class="ts-date">
              <span class="icon"><i class="far fa-calendar-alt"></i></span>
              <!-- <span>Thứ 2, 05/07/2021</span> -->
              <span style="text-transform: capitalize">{{vm.currentDate}}</span>
            </div>
            <div class="ts-branch">
              <span class="icon"><i class="fas fa-map-marker-alt"></i></span>
              <p>{{vm.branchName}}</p>
            </div>
          </div>
        </div>
      </div>
      <div ng-if="!vm.isHistoryMode" class="main-content clocking-mode">
        <!-- Add class "cloking-in" Với trường hơp chấm công vào và "cloking-out" Với ngược lại -->
        <div class="page-cloking-wrap cloking-in">
          <div class="cloking-shift">
            <div class="container">
              <div class="ts-dropdown">
                <a
                  class="ts-dropdowm-btn"
                  ng-click="vm.openAndCloseDropdown($event);"
                >
                  <span class="ts-dropdowm-result">Chọn ca làm việc</span>
                  <span class="ts-icon"
                    ><i class="fal fa-angle-right"></i
                  ></span>
                </a>
                <!-- Add class 'active-dropdown' để hiện dropdown ------  dropdown-menu  -->
                <ul id="shift-dropdown" class="dropdown-menu">
                  <li>Chọn ca làm việc</li>
                  <!-- <li class="time-before">Ca sáng: 08:00 - 12:30</li>
                  <li class="now">Ca sáng 2: 09:30 - 13:30</li> -->
                  <li
                    ng-repeat="x in vm.clockings"
                    ng-click="vm.onChangeShift(x)"
                    class="{{vm.checkShiftActive(x)}}"
                  >
                    {{x.shift.name}}: {{vm.toHHMM(x.shift.from)}} -
                    {{vm.toHHMM(x.shift.to)}}
                  </li>
                  <!-- <li>Ca tối: 18:30 - 22:30</li> -->
                </ul>
              </div>
            </div>
          </div>
          <div class="container">
            <div class="cloking-main">
                <span ng-if="vm.isCheckIn" class="time-clock cloking-in"></span>
                <span ng-if="!vm.isCheckIn" class="time-clock cloking-out"></span>
            </div>
            <div ng-if="vm.error" class="error-msg">{{vm.error.message}}</div>
            <div ng-if="vm.error.code == 'wrong_gps' && !vm.isCheckIn" class="cloking-button">
              <a ng-click="vm.submitClocking(false)" class="btn btn-outline  btn-outline-primary btn-back">Thử lại</a>
              <a ng-click="vm.submitClocking(true)" class="btn btn-outline  btn-outline-primary btn-send">Gửi xác nhận chấm công</a>
            </div>
            <div ng-if="vm.error.code == 'wrong_gps' && vm.isCheckIn" class="cloking-button">
                <a ng-click="vm.submitClocking(false)" class="btn btn-outline  btn-outline-success btn-back">Thử lại</a>
                <a ng-click="vm.submitClocking(true)" class="btn btn-outline  btn-outline-success btn-send">Gửi xác nhận chấm công</a>
              </div>
          </div>
        </div>
    </div>
    <!-- Show lịch sử chấm công. -->
    <div ng-if="vm.isHistoryMode" class="main-content history-mode">
        <!-- Add class "cloking-in" Với trường hơp chấm công vào và "cloking-out" Với ngược lại -->
        <div class="page-cloking-wrap cloking-in">
          <div class="cloking-in-out">
            <div class="cloking-item-in">
              <span class="icon"><i class="far fa-walking"></i></span>
              <span id="his-clocking-in">Vào: --:--</span>
            </div>
            <div class="cloking-item-out">
              <span class="icon"><i class="far fa-walking"></i></span>
              <span id="his-clocking-out">Ra: --:--</span>
            </div>
          </div>
          <div class="title-history"><h4>Lịch sử chấm công</h4></div>
          <div class="cloking-shift">
            <div class="container">
                <div class="ts-dropdown">
                    <a class="ts-dropdowm-btn" ng-click="vm.openAndCloseDropdown($event);">
                    <span class="ts-dropdowm-result">Chọn ca làm việc</span>
                    <span class="ts-icon"><i class="fal fa-angle-right"></i></span>
                    </a>
                    <!-- Add class 'active-dropdown' để hiện dropdown -->
                    <ul id="shift-dropdown" class="dropdown-menu">
                    <li>Chọn ca làm việc</li>
                    <li
                        ng-repeat="x in vm.clockings"
                        ng-click="vm.onChangeShift(x)"
                        class="{{vm.checkShiftActive(x)}}"
                    >
                        {{x.shift.name}}: {{vm.toHHMM(x.shift.from)}} -
                        {{vm.toHHMM(x.shift.to)}}
                    </li>
                    </ul>
                </div>
                </div>  
            </div>
            <div ng-if="vm.clocking.clockingHistories.length > 0" class="cloking-time">
                <ul class="cloking-time-items">
                    <li ng-repeat="x in vm.clocking.clockingHistories" class="cloking-time-item">
                        <span class="cloking-time-in">Giờ vào: {{vm.dateToHHMM(x.checkedInDate)}}</span>
                        <span class="cloking-time-out">Giờ vào: {{vm.dateToHHMM(x.checkedOutDate)}}</span>
                    </li>
                </ul>
            </div>
        </div>
      </div>
    </div>

    <div ng-if="!vm.isHistoryMode" class="footer">
      <div
        ng-if="!vm.error.code || vm.error.code != 'wrong_gps'"
        class="container"
      >
        <button
          ng-if="vm.isCheckIn"
          ng-click="vm.submitClocking(false)"
          class="btn btn-success btn-xl btn-in"
        >
          <i class="far fa-walking"></i>Chấm công vào
        </button>
        <button
          ng-if="!vm.isCheckIn"
          ng-click="vm.submitClocking(false)"
          class="btn btn-primary btn-xl btn-out"
        >
          <i class="far fa-walking"></i>Chấm công ra
        </button>
      </div>
    </div>
  </div>
</div>
<div id="loading">
  <img id="loading-image" src="../../../assets/img/spinner.gif" alt="Loading..." />
</div>